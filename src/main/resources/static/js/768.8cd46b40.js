"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[768],{1768:function(e,t,a){a.r(t),a.d(t,{default:function(){return p}});var r=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticClass:"box-card",staticStyle:{"margin-top":"10px"}},[t("el-row",[t("el-col",{attrs:{span:4}},[t("el-input",{attrs:{type:"text",size:"mini",placeholder:"根据用户昵称搜索"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}})],1),t("el-col",{attrs:{span:1}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleSearch}},[e._v("搜索")])],1)],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[t("el-table-column",{attrs:{prop:"name",label:"昵称"}}),t("el-table-column",{attrs:{prop:"phone",label:"手机号"}}),t("el-table-column",{attrs:{prop:"role.nameZh",label:"角色"}}),t("el-table-column",{attrs:{prop:"telephone",label:"固定电话"}}),t("el-table-column",{attrs:{prop:"address",label:"地址"}}),t("el-table-column",{attrs:{prop:"username",label:"用户名"}}),t("el-table-column",{attrs:{prop:"remark",label:"备注"}}),t("el-table-column",{attrs:{prop:"enabled",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.username==e.userInfo.username?t("el-tag",[e._v("当前用户")]):a.row.enabled?t("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.handleStatus(a.row)}}},[e._v("正常用户")]):e._e(),a.row.enabled?e._e():t("el-tag",{attrs:{type:"danger"},on:{click:function(t){return e.handleStatus(a.row)}}},[e._v("已封禁")])]}}])}),t("el-table-column",{attrs:{label:"操作",fixed:"right",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{disabled:!a.row.enabled,type:"primary",size:"mini"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")])]}}])})],1),t("UserForm",{ref:"userForm"}),t("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{"current-page":e.currentPage,"page-sizes":[3,5,7,10],"page-size":e.pageSize,layout:"->,sizes, prev, pager, next, jumper ,total",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},s=[],l=a(8486),o=a(4806),i=a.n(o),n={name:"SearchUser",components:{UserForm:l.Z},data(){return{searchKey:"",tableData:[],currentPage:1,pageSize:5,total:0,userInfo:{}}},mounted(){this.getUserList(),this.userInfo=JSON.parse(window.localStorage.getItem("userInfo"))},watch:{searchKey:{handler(){this.debouncedSearch()}}},methods:{async getUserList(){try{const e=await this.$UserApi.searchUser({name:this.searchKey,page:this.currentPage,size:this.pageSize});this.tableData=e.data,this.total=e.total}catch(e){this.$message.error("初始化数据失败~")}},handleSearch(){this.getUserList()},async handleEdit(e){try{const t=await this.$UserApi.getUserById(e.id);200==t.status&&(t.data.password=t.data.password.replace("{noop}",""),this.$refs.userForm.title="更新用户",this.$refs.userForm.form=t.data)}catch(t){this.$message.error("出错了aaaa")}this.$refs.userForm.dialogFormVisible=!0},handleSizeChange(e){this.pageSize=e,this.getUserList()},handleCurrentChange(e){this.currentPage=e,this.getUserList()},async handleStatus(e){if(e.enabled){const t=await this.$UserApi.deleteUser(e.id);this.$confirm("此操作将禁用该用户, 是否继续?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{200==t.status&&(this.$message({type:"success",message:"已禁用该用户"}),this.getUserList())})).catch((()=>{this.$message({type:"info",message:"已取消操作"})}))}else{const t=await this.$UserApi.deBlockedUser(e.id);this.$confirm("此操作将解禁该用户, 是否继续?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{200==t.status&&(this.$message({type:"success",message:"已禁用该用户"}),this.getUserList())})).catch((()=>{this.$message({type:"info",message:"已取消操作"})}))}},debouncedSearch:i().debounce((function(){this.getUserList()}),200)}},c=n,m=a(1001),u=(0,m.Z)(c,r,s,!1,null,null,null),p=u.exports},8486:function(e,t,a){a.d(t,{Z:function(){return c}});var r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.title,top:"5vh",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"昵称",prop:"name","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"手机号",prop:"phone","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),t("el-form-item",{attrs:{label:"角色",prop:"nameZh","label-width":e.formLabelWidth}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.rid,callback:function(t){e.$set(e.form,"rid",t)},expression:"form.rid"}},e._l(e.role,(function(e){return t("el-option",{key:e.rid,attrs:{label:e.nameZh,disabled:!e.enabled,value:e.rid}})})),1)],1),t("el-form-item",{attrs:{label:"固定电话",prop:"telephone","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.telephone,callback:function(t){e.$set(e.form,"telephone",t)},expression:"form.telephone"}})],1),t("el-form-item",{attrs:{label:"地址",prop:"address","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),t("el-form-item",{attrs:{label:"用户名",prop:"username","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),t("el-form-item",{attrs:{label:"头像","label-width":e.formLabelWidth}},[t("el-input",{attrs:{disabled:"",autocomplete:"off"},model:{value:e.form.userface,callback:function(t){e.$set(e.form,"userface",t)},expression:"form.userface"}})],1),t("el-form-item",{attrs:{label:"备注",prop:"remark","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1,e.resetForm("form")}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSumit}},[e._v("确 定")])],1)],1)},s=[],l={name:"addUserForm",data(){return{title:"",dialogFormVisible:!1,form:{name:"",rid:"",phone:"",telephone:"",address:"",username:"",password:"",userface:"http://bpic.588ku.com/element_pic/01/40/00/64573ce2edc0728.jpg",remark:""},formLabelWidth:"120px",role:[]}},mounted(){this.getRoleList()},methods:{async handleSumit(){if(this.dialogFormVisible=!1,"添加用户"==this.title)try{const e=await this.$UserApi.addUser(this.form);200===e.status&&(this.$message({type:"success",message:"添加成功！"}),this.resetForm("form"))}catch(e){this.$message.error("该用户已存在~")}if("更新用户"==this.title)try{const e=await this.$UserApi.editUser(this.form);200===e.status&&(this.$message({type:"success",message:"更新成功！"}),this.resetForm("form"),this.$parent.getUserList())}catch(e){this.$message.error("出错啦~")}},async getRoleList(){const e=await this.$UserApi.getAllRoleList();this.role=e.data},resetForm(e){this.$refs[e].resetFields()}}},o=l,i=a(1001),n=(0,i.Z)(o,r,s,!1,null,null,null),c=n.exports}}]);
//# sourceMappingURL=768.8cd46b40.js.map